<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>vSphere GuestStore: An easy way to update VMware Tools - blog.jsph.io</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=blog.jsph.io rel=home><div class="logo__item logo__text"><div class=logo__title>blog.jsph.io</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>vSphere GuestStore: An easy way to update VMware Tools</h1></header><div class="content post__content clearfix"><p>If your environment is offline, i.e. totally disconnected from the internet, it can be tough to update things. I&rsquo;ve dealt with this with WSUS, SCCM, and now VMware Tools. Let&rsquo;s make it easy.</p><h3 id=the-hard-way>The Hard Way</h3><p>Updating Tools on the ESXi host required uploading to the datastore, chmodding, some esxcli commands, and setting up symlinks(<a href=https://kb.vmware.com/s/article/2129825>Installing and upgrading the latest version of VMware Tools on existing hosts (2129825)</a>). While this is fine, it is a few more steps than I would like.</p><h3 id=the-new-way>The New Way</h3><p>Enter GuestStore. From VMware:</p><blockquote><p>The GuestStore feature provides a simple and flexible mechanism to distribute VMware specific or custom content from a GuestStore repository to multiple guests simultaneously.</p></blockquote><p>Enabling the GuestStore feature makes it easier to update VMware Tools on your VMs. You can also use it for other purposes like distributing scripts or configuration files.</p><h4 id=how-to-setup-gueststore>How to setup GuestStore</h4><p>There are some requirements before setting up the GuestStore:</p><p>Windows VMs:</p><ul><li>ESXi 7.0 U2 and later</li><li>VMware Tools 11.2.5 and later</li></ul><p>Linux VMs:</p><ul><li>ESXI 7.0 U3</li><li>Vmware Tools 11.3.0 and later</li></ul><p>Creating the GuestStore is simple and only requires a few steps.</p><ul><li>Create the folder on the datastore</li><li>Use esxcli to set the repository URL</li></ul><h5 id=create-the-gueststore-directory>Create the GuestStore directory</h5><p>In your datastore create a directory called &ldquo;GuestStore&rdquo;</p><p><img src=gdirectory.png alt=GuestStore></p><h4 id=configure-the-repo>Configure the repo</h4><p>SSH to your host. You may need to enable SSH first.</p><p>First find the UUID of your datastore:</p><pre tabindex=0><code>esxcli storage filesystem list
</code></pre><p>Then run this command:</p><pre tabindex=0><code>esxcli system settings gueststore repository set --url &#34;ds:///vmfs/volumes/&lt;datastore_uuid&gt;/GuestStore&#34;
</code></pre><p>Ensure that it was successfully set:</p><pre tabindex=0><code>esxcli system settings gueststore repository get
</code></pre><h4 id=upload-the-latest-vmware-tools>Upload the latest VMware Tools</h4><p>Download the VMware Tools packages for GuestStore ZIP from <a href="https://customerconnect.vmware.com/en/downloads/details?downloadGroup=VMTOOLS1205&productId=1259&rPId=88838">Download VMware Tools</a>. Unzip it and then upload the vmware directory to the GuestStore directory you created on the datastore.</p><p><img src=vmwaredir.png alt="vmware directory"></p><h4 id=updating-vmware-tools>Updating VMware Tools</h4><p>Now your VMs should be showing that a newer version of Vmware Tools is available to install.</p><p><img src=updateavail.png alt="Update Available"></p><h3 id=thats-it>That&rsquo;s it!</h3><p>In the next post I will go over how you can globaly configure VMware Tools to pull from the repo and install automatically.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/vmware/ rel=tag>vmware</a></li><li class=tags__item><a class="tags__link btn" href=/tags/vcenter/ rel=tag>vcenter</a></li><li class=tags__item><a class="tags__link btn" href=/tags/gueststore/ rel=tag>gueststore</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="Joseph Warren avatar" src=/avatar.jpg class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name>About Joseph Warren</span></div><div class=authorbox__description>Just techin&rsquo; around</div></div></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2022 Joseph Warren.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>